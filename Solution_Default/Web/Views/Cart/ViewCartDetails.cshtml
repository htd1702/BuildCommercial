@using Web.Resources.ShopingCart
<ul class="header-cart-wrapitem w-full">
    @foreach (Web.Infrastructure.Core.InfoCart p in Web.Infrastructure.Core.ShoppingCart.Cart.Items)
    {
        <li class="header-cart-item flex-w flex-t m-b-12">
            <div class="header-cart-item-img" data-id="@p.ID" data-color="@p.ColorID" data-size="@p.SizeID">
                <img src="@p.Image" alt="IMG">
            </div>

            <div class="header-cart-item-txt p-t-8" style="padding:0;margin-top:-20px;">
                <a href="#" class="header-cart-item-name m-b-18 hov-cl1 trans-04"></a>

                @if (Request.Cookies["Lang"] != null && Request.Cookies["Lang"].Value == "vi")
                {
                    <span>@p.NameVN</span>
                    <br />
                    <span>@p.ColorName,@p.SizeName</span>
                    <span class="header-cart-item-info">
                        @p.Quantity x @Html.FormatValue(p.PriceVN, "{0:C}")
                    </span>
                }
                else if (Request.Cookies["Lang"] != null && Request.Cookies["Lang"].Value == "fr")
                {
                    <span>@p.NameFr</span>
                    <br />
                    <span>@p.ColorName,@p.SizeName</span>
                    <span class="header-cart-item-info">
                        @p.Quantity x @p.PriceFr
                    </span>
                }
                else
                {
                    <span>@p.Name</span>
                    <br />
                    <span>@p.ColorName,@p.SizeName</span>
                    <span class="header-cart-item-info">
                        @p.Quantity x $@string.Format("{0:#,##0.00}", p.Price)
                    </span>
                }
            </div>
        </li>
    }
</ul>

<div class="w-full">
    <div class="header-cart-total w-full p-tb-40">
        @if (Request.Cookies["Lang"] != null && Request.Cookies["Lang"].Value == "vi")
        {
            <span>Total: @Html.FormatValue(Web.Infrastructure.Core.ShoppingCart.Cart.TotalVN, "{0:C}")</span>
        }
        else if (Request.Cookies["Lang"] != null && Request.Cookies["Lang"].Value == "fr")
        {
            <span>Total: @Html.FormatValue(Web.Infrastructure.Core.ShoppingCart.Cart.TotalFr, "{0:C}")</span>
        }
        else
        {
            <span>Total: $@string.Format("{0:#,##0.00}", Web.Infrastructure.Core.ShoppingCart.Cart.Total)</span>
        }
    </div>

    <div class="header-cart-buttons flex-w w-full">
        <a href="/view-cart" class="flex-c-m stext-101 cl0 size-107 bor2 hov-btn3 p-lr-15 trans-04 m-r-8 m-b-10 btn-info">
            @re_ShopingCart.ViewCart
        </a>

        <a href="/check-out" class="flex-c-m stext-101 cl0 size-107 bor2 hov-btn3 p-lr-15 trans-04 m-b-10 btn-success">
            @re_ShopingCart.CheckOut
        </a>
    </div>
</div>

<script>
     //remove shopping cart
    $(".header-cart-item-img").click(function () {
        var pid = $(this).attr("data-id");
        var colorID = $(this).attr("data-color");
        var sizeID = $(this).attr("data-size");
        swal({
            title: "Are you sure?",
            text: "Do you want to remove this product from your shopping cart?",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        }).then((willDelete) => {
            if (willDelete) {
                swal("Success", {
                    icon: "success",
                }).then(function () {
                    $.ajax({
                        url: "/Cart/Remove",
                        data: { id: pid, colorID: colorID, sizeID: sizeID },
                        type: "post",
                        async: false,
                        success: function (response) {
                            $(".shopping-cart-des").attr("data-notify", response.Count);
                            $(".shopping-cart-mobi").attr("data-notify", response.Count);
                        },
                        error: function (error) {
                            console.log(error);
                        }
                    });
                    $.ajax({
                        url: "/Cart/ViewCartDetails",
                        async: false,
                        success: function (response) {
                            $("#page_ShoppingCart").html(response);
                        },
                        error: function (error) {
                            console.log(error);
                        }
                    });
                });
            }
        });
    });
</script>